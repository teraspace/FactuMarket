flowchart TB
    %% === Sistema FactuMarket ===
    subgraph U["Usuario / Aplicación Cliente"]
        U1["Cliente Web / App Móvil"]
    end

    subgraph F["Facturas API (Ruby / Oracle)"]
        F1["Controlador REST"]
        F2["Lógica de negocio (CrearFactura)"]
        F3["Persistencia Oracle"]
        F4["Gateway DIAN (Simulado)"]
    end

    subgraph C["Clientes API (.NET / Oracle)"]
        C1["Controlador REST"]
        C2["Persistencia Oracle"]
    end

    subgraph A["Auditoría API (Ruby / MongoDB)"]
        A1["Endpoint /events"]
        A2["MongoDB (Logs y Auditoría)"]
    end

    U1 -->|POST /facturas| F1
    F1 --> F2
    F2 -->|GET /clientes/:id| C1
    C1 --> C2
    F2 -->|Guardar Factura| F3
    F2 -->|Enviar a DIAN| F4
    F2 -->|POST /events| A1
    A1 --> A2
